<!-- Loading Skeleton -->
<div *ngIf="isLoading">
  <ion-list>
    <ion-card class="asphalt-card-skeleton" *ngFor="let i of [1,2,3]">
      <div class="card-header-row">
        <div class="card-text">
          <ion-skeleton-text animated style="width: 60%; height: 20px; margin-bottom: 6px;"></ion-skeleton-text>
          <ion-skeleton-text animated style="width: 40%; height: 16px;"></ion-skeleton-text>
        </div>
        <ion-skeleton-text class="club-thumbnail-skeleton" animated></ion-skeleton-text>
      </div>

      <ion-skeleton-text animated style="width: 90%; margin: 8px 16px;"></ion-skeleton-text>
      <ion-skeleton-text animated style="width: 80%; margin: 0 16px 16px;"></ion-skeleton-text>

      <div class="footer-skeleton">
        <ion-skeleton-text animated style="width: 30%; height: 20px;"></ion-skeleton-text>
        <ion-skeleton-text animated style="width: 30%; height: 20px;"></ion-skeleton-text>
      </div>
    </ion-card>

  </ion-list>
</div>

<!-- Error Message -->
<div *ngIf="error" class="ion-text-center error-message">
  <ion-icon name="cloud-offline-outline"></ion-icon>
  <p>{{ error }}</p>
  <ion-button fill="clear" (click)="loadClubs()">Try Again</ion-button>
</div>

<!-- Club List -->
<div *ngIf="!isLoading && !error">
  <ng-container *ngIf="(clubs$ | async) as clubs">
    <ion-list *ngIf="clubs.length > 0; else noClubsTemplate">
      <ion-card *ngFor="let club of clubs" class="asphalt-card" [routerLink]="['/clubs', club.id]">
        <div class="card-header-row">
          <div class="card-text">
            <ion-card-title>{{ club.clubName }}</ion-card-title>
            <ion-card-subtitle>{{ club.location || 'Location not specified' }}</ion-card-subtitle>
          </div>
          <img class="club-thumbnail" [src]="club.logoUrl || ('https://picsum.photos/100/100?random=' + club.id)"
            alt="Club Logo" />
        </div>

        <ion-card-content>
          {{ club.description }}
        </ion-card-content>

        <div class="card-footer">
          <div class="footer-item">
            <ion-icon name="people-outline"></ion-icon>
            <span>{{ club.members?.length || 0 }} Members</span>
          </div>
          <div class="footer-item">
            <ion-icon [name]="club.isPrivate ? 'lock-closed-outline' : 'lock-open-outline'"></ion-icon>
            <span>{{ club.isPrivate ? 'Private' : 'Public' }}</span>
          </div>
        </div>
      </ion-card>
    </ion-list>

    <!-- Template for when there are no clubs -->
    <ng-template #noClubsTemplate>
      <div class="ion-text-center empty-state">
        <ion-icon name="sad-outline"></ion-icon>
        <p>No clubs found.</p>
        <p>Why not be the first to create one?</p>
      </div>
    </ng-template>
  </ng-container>
</div>