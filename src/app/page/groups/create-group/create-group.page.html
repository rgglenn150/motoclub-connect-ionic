<!-- 
  Redesigned Create Group Page
  - Applies the "Asphalt UI" theme for a consistent look and feel.
  - Adds key features: Group Privacy toggle and an Image Uploader.
  - Uses more descriptive labels and icons for better usability.
-->
<ion-header class="asphalt-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Create New Club</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="asphalt-background">
  <form [formGroup]="createGroupForm" (ngSubmit)="registerGroup()">
    <div class="ion-padding">

      <!-- Group Image Uploader -->
      <div class="image-uploader ion-text-center" (click)="fileInput.click()">
        <img *ngIf="groupImagePreview" [src]="groupImagePreview" class="group-image-preview" />
        <div *ngIf="!groupImagePreview" class="placeholder">
          <ion-icon name="camera-outline" class="placeholder-icon"></ion-icon>
          <ion-label>Upload Club Logo</ion-label>
        </div>
        <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" class="ion-hide" />
      </div>

      <!-- Cropper Modal-like Section -->
      <div *ngIf="cropperVisible" class="cropper-container">
        <image-cropper
          [imageChangedEvent]="imageChangedEvent"
          [maintainAspectRatio]="true"
          [aspectRatio]="1"
          [resizeToWidth]="512"
          [imageQuality]="0.92"
          format="png"
          (imageCropped)="onImageCropped($event)"
          (cropperReady)="onCropperReady()"
          (loadImageFailed)="onCropperLoadImageFailed()"
        ></image-cropper>
        <div class="cropper-actions">
          <ion-button fill="clear" color="medium" (click)="cancelCrop()">Cancel</ion-button>
          <ion-button class="asphalt-button-primary" (click)="applyCrop()">Apply</ion-button>
        </div>
      </div>

      <!-- Group Name -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-input formControlName="name" type="text" placeholder="Club Name"></ion-input>
      </ion-item>

      <!-- Group Description -->
      <ion-item class="asphalt-textarea-item" lines="none">
        <ion-textarea formControlName="description" placeholder="Club Description (e.g., goals, riding style)" [autoGrow]="true"></ion-textarea>
      </ion-item>

      <!-- Group Location -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-icon name="location-outline" slot="start" class="asphalt-icon"></ion-icon>
        <ion-input formControlName="location" type="text" placeholder="Home Base (e.g., City, State)"></ion-input>
      </ion-item>

      <!-- Group Privacy Toggle -->
      <ion-item class="asphalt-toggle-item" lines="none">
        <ion-label>Private Club</ion-label>
        <ion-toggle formControlName="isPrivate" slot="end" class="asphalt-toggle"></ion-toggle>
      </ion-item>
      <p class="field-description">
        Private clubs require approval for new members to join. Public clubs are open for anyone.
      </p>

    </div>
  </form>
</ion-content>

<ion-footer class="asphalt-footer">
  <ion-toolbar>
    <ion-button 
      expand="block" 
      class="asphalt-button-primary" 
      (click)="registerGroup()" 
      [disabled]="createGroupForm.invalid">
      Create Club
    </ion-button>
  </ion-toolbar>
</ion-footer>
