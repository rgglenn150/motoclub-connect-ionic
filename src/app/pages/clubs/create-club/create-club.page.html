<!-- 
  Redesigned Create Club Page
  - Applies the "Asphalt UI" theme for a consistent look and feel.
  - Adds key features: Club Privacy toggle and an Image Uploader.
  - Uses more descriptive labels and icons for better usability.
-->
<ion-header class="asphalt-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Create New Club</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="asphalt-background">
  <!-- Loading Spinner Overlay -->
  <app-loading-spinner [isLoading]="isLoading"></app-loading-spinner>
  
  <form [formGroup]="createClubForm" (ngSubmit)="registerClub()">
    <div class="ion-padding">

      <!-- Club Image Uploader -->
      <div class="image-uploader ion-text-center" (click)="fileInput.click()">
        <img *ngIf="clubImagePreview" [src]="clubImagePreview" class="club-image-preview" />
        <div *ngIf="!clubImagePreview" class="placeholder">
          <ion-icon name="camera-outline" class="placeholder-icon"></ion-icon>
          <ion-label>Upload Club Logo</ion-label>
        </div>
        <input type="file" #fileInput (change)="onFileSelected($event)" accept="image/*" class="ion-hide" />
      </div>

      <!-- Cropper Modal-like Section -->
      <div *ngIf="cropperVisible" class="cropper-container">
        <image-cropper
          [imageChangedEvent]="imageChangedEvent"
          [maintainAspectRatio]="true"
          [aspectRatio]="1"
          [resizeToWidth]="512"
          [imageQuality]="0.92"
          format="png"
          (imageCropped)="onImageCropped($event)"
          (cropperReady)="onCropperReady()"
          (loadImageFailed)="onCropperLoadImageFailed()"
        ></image-cropper>
        <div class="cropper-actions">
          <ion-button fill="clear" color="medium" (click)="cancelCrop()">Cancel</ion-button>
          <ion-button class="asphalt-button-primary" (click)="applyCrop()">Apply</ion-button>
        </div>
      </div>

      <!-- Club Name -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-input formControlName="name" type="text" placeholder="Club Name"></ion-input>
      </ion-item>

      <!-- Club Description -->
      <ion-item class="asphalt-textarea-item" lines="none">
        <ion-textarea formControlName="description" placeholder="Club Description (e.g., goals, riding style)" [autoGrow]="true"></ion-textarea>
      </ion-item>

      <!-- Club Location -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-icon name="location-outline" slot="start" class="asphalt-icon"></ion-icon>
        <ion-input formControlName="location" type="text" placeholder="Home Base (e.g., City, State)"></ion-input>
      </ion-item>

      <!-- Club Privacy Toggle -->
      <ion-item class="asphalt-toggle-item" lines="none">
        <ion-toggle formControlName="isPrivate" slot="end" class="asphalt-toggle" aria-label="Private Club">Private Club</ion-toggle>
      </ion-item>
      <p class="field-description">
        Private clubs require approval for new members to join. Public clubs are open for anyone.
      </p>

    </div>
  </form>
</ion-content>

<ion-footer class="asphalt-footer">
  <ion-toolbar>
    <ion-button 
      expand="block" 
      class="asphalt-button-primary" 
      (click)="registerClub()" 
      [disabled]="createClubForm.invalid">
      Create Club
    </ion-button>
  </ion-toolbar>
</ion-footer>
