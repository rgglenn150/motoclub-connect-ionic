<!-- 
  Redesigned Login Page
  - Applies the "Asphalt UI" dark theme.
  - Introduces a strong visual hierarchy.
  - Adds icons and clearer calls-to-action.
-->
<ion-content class="asphalt-background">
  <div class="login-container">

    <!-- App Logo/Title Section -->
    <div class="ion-text-center title-section">
      <h1 class="app-title">MotoClub Connect</h1>
      <p class="app-subtitle">Sign in to join the ride</p>
    </div>

    <!-- Login Form -->
    <form [formGroup]="loginForm" (ngSubmit)="login()" class="login-form">
      
      <!-- Email Input with Icon -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-icon name="mail-outline" slot="start" class="asphalt-icon"></ion-icon>
        <ion-input 
          formControlName="email" 
          type="email" 
          placeholder="Email"
          class="asphalt-input">
        </ion-input>
      </ion-item>

      <!-- Password Input with Icon -->
      <ion-item class="asphalt-input-item" lines="none">
        <ion-icon name="lock-closed-outline" slot="start" class="asphalt-icon"></ion-icon>
        <ion-input 
          formControlName="password" 
          type="password" 
          placeholder="Password"
          class="asphalt-input">
        </ion-input>
      </ion-item>

      <!-- Forgot Password Link -->
      <div class="ion-text-right forgot-password-link">
        <ion-button fill="clear" size="small" class="asphalt-text-button">Forgot Password?</ion-button>
      </div>

      <!-- Error Message Display -->
      <div *ngIf="errorMessage" class="error-message ion-text-center">
        {{ errorMessage }}
      </div>

      <!-- Login Button -->
      <ion-button 
        type="submit"
        expand="block" 
        class="asphalt-button-primary"
        [disabled]="loginForm.invalid">
        Login
      </ion-button>

    </form>

    <!-- OR Divider -->
    <div class="divider-container">
      <div class="divider-line"></div>
      <span class="divider-text">OR</span>
      <div class="divider-line"></div>
    </div>

    <!-- Facebook Login Button -->
    <ion-button 
      expand="block" 
      class="facebook-button"
      (click)="loginWithFacebook()"
      [disabled]="isFacebookLoading">
      <ion-icon slot="start" name="logo-facebook" class="facebook-icon"></ion-icon>
      <ion-spinner *ngIf="isFacebookLoading" name="crescent" class="facebook-spinner"></ion-spinner>
      <span *ngIf="!isFacebookLoading">Continue with Facebook</span>
      <span *ngIf="isFacebookLoading">Connecting...</span>
    </ion-button>

    <!-- Registration Link -->
    <div class="ion-text-center register-link">
      <p>Don't have an account? 
        <ion-button fill="clear" size="small" (click)="goToRegister()" class="asphalt-text-button">
          Sign Up
        </ion-button>
      </p>
    </div>

    <!-- PWA Install Button -->
    <div *ngIf="showInstallButton" class="ion-text-center install-link" style="margin-top: 1rem;">
        <ion-button fill="outline" (click)="installPwa()" class="asphalt-button-secondary">
          <ion-icon slot="start" name="download-outline"></ion-icon>
          Install App
        </ion-button>
    </div>

  </div>
</ion-content>

<app-loading-spinner [isLoading]="isLoading"></app-loading-spinner>